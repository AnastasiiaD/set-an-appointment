{"ast":null,"code":"import _classCallCheck from \"/Users/admin/training/get-news/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/admin/training/get-news/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/admin/training/get-news/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/admin/training/get-news/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/admin/training/get-news/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/admin/training/get-news/src/common/withAuth/withAuth.js\";\nimport React, { Component } from 'react';\nimport { Redirect } from 'react-router-dom';\nimport { connect } from \"react-redux\";\nimport { setWeatherIsValid } from \"./../../actions/tokenActions\";\n\nfunction withAuth(ComponentToProtect, isPrivatePath) {\n  return (\n    /*#__PURE__*/\n    function (_Component) {\n      _inherits(_class, _Component);\n\n      function _class() {\n        var _this;\n\n        _classCallCheck(this, _class);\n\n        _this = _possibleConstructorReturn(this, _getPrototypeOf(_class).call(this));\n        _this.state = {\n          isTokenValid: false,\n          loading: true\n        };\n        return _this;\n      }\n\n      _createClass(_class, [{\n        key: \"componentWillMount\",\n        value: function componentWillMount() {\n          var _this2 = this;\n\n          this.props.checkToken().then(function (res) {\n            if (res.status === 200) {\n              _this2.setState({\n                isTokenValid: true\n              });\n            } else {\n              var error = new Error(res.error);\n              throw error;\n            }\n          }).catch(function (err) {\n            console.error(err);\n          });\n        }\n      }, {\n        key: \"render\",\n        value: function render() {\n          var isTokenValid = this.state.isTokenValid;\n          var token = this.props.token;\n\n          if (!token.isChecked) {\n            return null;\n          } else if (!isTokenValid && isPrivatePath && token.isChecked) {\n            return React.createElement(Redirect, {\n              to: \"/signin\",\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 38\n              },\n              __self: this\n            });\n          } else {\n            return React.createElement(ComponentToProtect, Object.assign({}, this.props, {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 41\n              },\n              __self: this\n            }));\n          }\n        }\n      }]);\n\n      return _class;\n    }(Component)\n  );\n}\n\nvar mapStateToProps = function mapStateToProps(_ref) {\n  var token = _ref.token;\n  return {\n    token: token\n  };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return {\n    checkToken: function checkToken() {\n      return dispatch(setWeatherIsValid());\n    }\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(withAuth);","map":{"version":3,"sources":["/Users/admin/training/get-news/src/common/withAuth/withAuth.js"],"names":["React","Component","Redirect","connect","setWeatherIsValid","withAuth","ComponentToProtect","isPrivatePath","state","isTokenValid","loading","props","checkToken","then","res","status","setState","error","Error","catch","err","console","token","isChecked","mapStateToProps","mapDispatchToProps","dispatch"],"mappings":";;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,QAAT,QAAyB,kBAAzB;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,SAASC,iBAAT,QAAkC,8BAAlC;;AAEA,SAASC,QAAT,CAAkBC,kBAAlB,EAAsCC,aAAtC,EAAqD;AACjD;AAAA;AAAA;AAAA;;AACI,wBAAc;AAAA;;AAAA;;AACV;AACA,cAAKC,KAAL,GAAa;AACTC,UAAAA,YAAY,EAAE,KADL;AAETC,UAAAA,OAAO,EAAE;AAFA,SAAb;AAFU;AAOb;;AARL;AAAA;AAAA,6CAUyB;AAAA;;AACjB,eAAKC,KAAL,CAAWC,UAAX,GACKC,IADL,CACU,UAAAC,GAAG,EAAI;AACT,gBAAIA,GAAG,CAACC,MAAJ,KAAe,GAAnB,EAAwB;AACpB,cAAA,MAAI,CAACC,QAAL,CAAc;AAAEP,gBAAAA,YAAY,EAAE;AAAhB,eAAd;AACH,aAFD,MAEO;AACH,kBAAMQ,KAAK,GAAG,IAAIC,KAAJ,CAAUJ,GAAG,CAACG,KAAd,CAAd;AACA,oBAAMA,KAAN;AACH;AACJ,WARL,EASKE,KATL,CASW,UAAAC,GAAG,EAAI;AACVC,YAAAA,OAAO,CAACJ,KAAR,CAAcG,GAAd;AACH,WAXL;AAYH;AAvBL;AAAA;AAAA,iCAyBa;AAAA,cACGX,YADH,GACoB,KAAKD,KADzB,CACGC,YADH;AAAA,cAEGa,KAFH,GAEa,KAAKX,KAFlB,CAEGW,KAFH;;AAGL,cAAI,CAACA,KAAK,CAACC,SAAX,EAAsB;AAClB,mBAAO,IAAP;AACH,WAFD,MAEO,IAAI,CAACd,YAAD,IAAiBF,aAAjB,IAAkCe,KAAK,CAACC,SAA5C,EAAuD;AAC1D,mBAAO,oBAAC,QAAD;AAAU,cAAA,EAAE,EAAC,SAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAAP;AACH,WAFM,MAEA;AACH,mBACI,oBAAC,kBAAD,oBAAwB,KAAKZ,KAA7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eADJ;AAGH;AAEJ;AAtCL;;AAAA;AAAA,MAAqBV,SAArB;AAAA;AAwCH;;AAED,IAAMuB,eAAe,GAAG,SAAlBA,eAAkB;AAAA,MAAEF,KAAF,QAAEA,KAAF;AAAA,SAAc;AAClCA,IAAAA,KAAK,EAALA;AADkC,GAAd;AAAA,CAAxB;;AAGA,IAAMG,kBAAkB,GAAG,SAArBA,kBAAqB,CAAAC,QAAQ;AAAA,SAAK;AACpCd,IAAAA,UAAU,EAAE;AAAA,aAAMc,QAAQ,CAACtB,iBAAiB,EAAlB,CAAd;AAAA;AADwB,GAAL;AAAA,CAAnC;;AAIA,eAAeD,OAAO,CAACqB,eAAD,EAAkBC,kBAAlB,CAAP,CAA6CpB,QAA7C,CAAf","sourcesContent":["import React, { Component } from 'react';\nimport { Redirect } from 'react-router-dom';\nimport { connect } from \"react-redux\";\nimport { setWeatherIsValid } from \"./../../actions/tokenActions\";\n\nfunction withAuth(ComponentToProtect, isPrivatePath) {\n    return class extends Component {\n        constructor() {\n            super();\n            this.state = {\n                isTokenValid: false,\n                loading: true,\n            };\n\n        }\n\n        componentWillMount() {\n            this.props.checkToken()\n                .then(res => {\n                    if (res.status === 200) {\n                        this.setState({ isTokenValid: true });\n                    } else {\n                        const error = new Error(res.error);\n                        throw error;\n                    }\n                })\n                .catch(err => {\n                    console.error(err);\n                });\n        };\n\n        render() {\n            const { isTokenValid } = this.state;\n            const { token } = this.props;\n            if (!token.isChecked) {\n                return null;\n            } else if (!isTokenValid && isPrivatePath && token.isChecked) {\n                return <Redirect to=\"/signin\" />;\n            } else {\n                return (\n                    <ComponentToProtect {...this.props} />\n                );\n            }\n\n        }\n    }\n}\n\nconst mapStateToProps = ({token}) => ({\n    token,\n});\nconst mapDispatchToProps = dispatch => ({\n    checkToken: () => dispatch(setWeatherIsValid())\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(withAuth);\n"]},"metadata":{},"sourceType":"module"}