{"ast":null,"code":"import _classCallCheck from \"/Users/admin/training/get-news/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/admin/training/get-news/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/admin/training/get-news/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/admin/training/get-news/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/admin/training/get-news/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/admin/training/get-news/src/common/withAuth/withAuth.js\";\nimport React, { Component } from 'react';\nimport { Redirect } from 'react-router-dom';\nimport { connect } from \"react-redux\";\nimport { setWeatherIsValid, setWeatherIsChecked as _setWeatherIsChecked } from \"./../../actions/tokenActions\";\nexport default function withAuth(ComponentToProtect, isPrivatePath) {\n  var PageComponent =\n  /*#__PURE__*/\n  function (_Component) {\n    _inherits(PageComponent, _Component);\n\n    function PageComponent() {\n      var _this;\n\n      _classCallCheck(this, PageComponent);\n\n      _this = _possibleConstructorReturn(this, _getPrototypeOf(PageComponent).call(this));\n      _this.state = {\n        isTokenValid: false,\n        loading: true\n      };\n      return _this;\n    }\n\n    _createClass(PageComponent, [{\n      key: \"componentWillMount\",\n      value: function componentWillMount() {\n        var _this2 = this;\n\n        this.props.checkToken().then(function () {\n          console.log('then');\n\n          if (_this2.props.token.isTokenValid) {\n            _this2.setState({\n              isTokenValid: true\n            });\n          } else {\n            _this2.setState({\n              isTokenValid: false\n            });\n          }\n        }).catch(function (err) {\n          console.error(err);\n        });\n      }\n    }, {\n      key: \"render\",\n      value: function render() {\n        console.log('render');\n        var isTokenValid = this.state.isTokenValid;\n        var token = this.props.token;\n\n        if (!isPrivatePath) {\n          console.log('1');\n          this.props.setWeatherIsChecked(false);\n          return React.createElement(ComponentToProtect, Object.assign({}, this.props, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 40\n            },\n            __self: this\n          }));\n        } else if (!token.isChecked && !isTokenValid && isPrivatePath) {\n          console.log('2');\n          this.props.setWeatherIsChecked(false);\n          return null;\n        } else if (!isTokenValid && isPrivatePath && token.isChecked) {\n          console.log('3');\n          this.props.setWeatherIsChecked(false);\n          return React.createElement(Redirect, {\n            to: \"/signin\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 49\n            },\n            __self: this\n          });\n        }\n      }\n    }]);\n\n    return PageComponent;\n  }(Component);\n\n  var mapStateToProps = function mapStateToProps(_ref) {\n    var token = _ref.token;\n    return {\n      token: token\n    };\n  };\n\n  var mapDispatchToProps = function mapDispatchToProps(dispatch) {\n    return {\n      checkToken: function checkToken() {\n        return dispatch(setWeatherIsValid());\n      },\n      setWeatherIsChecked: function setWeatherIsChecked() {\n        return dispatch(_setWeatherIsChecked());\n      }\n    };\n  };\n\n  return connect(mapStateToProps, mapDispatchToProps)(PageComponent);\n}","map":{"version":3,"sources":["/Users/admin/training/get-news/src/common/withAuth/withAuth.js"],"names":["React","Component","Redirect","connect","setWeatherIsValid","setWeatherIsChecked","withAuth","ComponentToProtect","isPrivatePath","PageComponent","state","isTokenValid","loading","props","checkToken","then","console","log","token","setState","catch","err","error","isChecked","mapStateToProps","mapDispatchToProps","dispatch"],"mappings":";;;;;;AAAA,OAAOA,KAAP,IAAeC,SAAf,QAA+B,OAA/B;AACA,SAAQC,QAAR,QAAuB,kBAAvB;AACA,SAAQC,OAAR,QAAsB,aAAtB;AACA,SAAQC,iBAAR,EAA2BC,mBAAmB,IAAnBA,oBAA3B,QAAqD,8BAArD;AAEA,eAAe,SAASC,QAAT,CAAkBC,kBAAlB,EAAsCC,aAAtC,EAAqD;AAAA,MAC1DC,aAD0D;AAAA;AAAA;AAAA;;AAE5D,6BAAc;AAAA;;AAAA;;AACV;AACA,YAAKC,KAAL,GAAa;AACTC,QAAAA,YAAY,EAAE,KADL;AAETC,QAAAA,OAAO,EAAE;AAFA,OAAb;AAFU;AAOb;;AAT2D;AAAA;AAAA,2CAWvC;AAAA;;AACjB,aAAKC,KAAL,CAAWC,UAAX,GACKC,IADL,CACU,YAAM;AACZC,UAAAA,OAAO,CAACC,GAAR,CAAY,MAAZ;;AACI,cAAI,MAAI,CAACJ,KAAL,CAAWK,KAAX,CAAiBP,YAArB,EAAmC;AAC/B,YAAA,MAAI,CAACQ,QAAL,CAAc;AAACR,cAAAA,YAAY,EAAE;AAAf,aAAd;AACH,WAFD,MAEO;AACH,YAAA,MAAI,CAACQ,QAAL,CAAc;AAACR,cAAAA,YAAY,EAAE;AAAf,aAAd;AACH;AACJ,SARL,EASKS,KATL,CASW,UAAAC,GAAG,EAAI;AACVL,UAAAA,OAAO,CAACM,KAAR,CAAcD,GAAd;AACH,SAXL;AAYH;AAxB2D;AAAA;AAAA,+BA0BnD;AACLL,QAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ;AADK,YAEEN,YAFF,GAEkB,KAAKD,KAFvB,CAEEC,YAFF;AAAA,YAGEO,KAHF,GAGW,KAAKL,KAHhB,CAGEK,KAHF;;AAIL,YAAI,CAACV,aAAL,EAAoB;AAChBQ,UAAAA,OAAO,CAACC,GAAR,CAAY,GAAZ;AACA,eAAKJ,KAAL,CAAWR,mBAAX,CAA+B,KAA/B;AACA,iBACI,oBAAC,kBAAD,oBAAwB,KAAKQ,KAA7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aADJ;AAGH,SAND,MAMO,IAAI,CAACK,KAAK,CAACK,SAAP,IAAoB,CAACZ,YAArB,IAAqCH,aAAzC,EAAwD;AAC3DQ,UAAAA,OAAO,CAACC,GAAR,CAAY,GAAZ;AACA,eAAKJ,KAAL,CAAWR,mBAAX,CAA+B,KAA/B;AACA,iBAAO,IAAP;AACH,SAJM,MAIA,IAAI,CAACM,YAAD,IAAiBH,aAAjB,IAAkCU,KAAK,CAACK,SAA5C,EAAuD;AAC1DP,UAAAA,OAAO,CAACC,GAAR,CAAY,GAAZ;AACA,eAAKJ,KAAL,CAAWR,mBAAX,CAA+B,KAA/B;AACA,iBAAO,oBAAC,QAAD;AAAU,YAAA,EAAE,EAAC,SAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAAP;AACH;AACJ;AA7C2D;;AAAA;AAAA,IACpCJ,SADoC;;AAgDhE,MAAMuB,eAAe,GAAG,SAAlBA,eAAkB;AAAA,QAAEN,KAAF,QAAEA,KAAF;AAAA,WAAc;AAClCA,MAAAA,KAAK,EAALA;AADkC,KAAd;AAAA,GAAxB;;AAIA,MAAMO,kBAAkB,GAAG,SAArBA,kBAAqB,CAAAC,QAAQ;AAAA,WAAK;AACpCZ,MAAAA,UAAU,EAAE;AAAA,eAAMY,QAAQ,CAACtB,iBAAiB,EAAlB,CAAd;AAAA,OADwB;AAEpCC,MAAAA,mBAAmB,EAAE;AAAA,eAAMqB,QAAQ,CAACrB,oBAAmB,EAApB,CAAd;AAAA;AAFe,KAAL;AAAA,GAAnC;;AAKA,SAAOF,OAAO,CAACqB,eAAD,EAAkBC,kBAAlB,CAAP,CAA6ChB,aAA7C,CAAP;AACH","sourcesContent":["import React, {Component} from 'react';\nimport {Redirect} from 'react-router-dom';\nimport {connect} from \"react-redux\";\nimport {setWeatherIsValid, setWeatherIsChecked} from \"./../../actions/tokenActions\";\n\nexport default function withAuth(ComponentToProtect, isPrivatePath) {\n    class PageComponent extends Component {\n        constructor() {\n            super();\n            this.state = {\n                isTokenValid: false,\n                loading: true,\n            };\n\n        }\n\n        componentWillMount() {\n            this.props.checkToken()\n                .then(() => {\n                console.log('then');\n                    if (this.props.token.isTokenValid) {\n                        this.setState({isTokenValid: true});\n                    } else {\n                        this.setState({isTokenValid: false});\n                    }\n                })\n                .catch(err => {\n                    console.error(err);\n                });\n        };\n\n        render() {\n            console.log('render');\n            const {isTokenValid} = this.state;\n            const {token} = this.props;\n            if (!isPrivatePath) {\n                console.log('1');\n                this.props.setWeatherIsChecked(false);\n                return (\n                    <ComponentToProtect {...this.props} />\n                );\n            } else if (!token.isChecked && !isTokenValid && isPrivatePath) {\n                console.log('2');\n                this.props.setWeatherIsChecked(false);\n                return null;\n            } else if (!isTokenValid && isPrivatePath && token.isChecked) {\n                console.log('3');\n                this.props.setWeatherIsChecked(false);\n                return <Redirect to=\"/signin\"/>;\n            }\n        }\n    }\n\n    const mapStateToProps = ({token}) => ({\n        token,\n    });\n\n    const mapDispatchToProps = dispatch => ({\n        checkToken: () => dispatch(setWeatherIsValid()),\n        setWeatherIsChecked: () => dispatch(setWeatherIsChecked()),\n    });\n\n    return connect(mapStateToProps, mapDispatchToProps)(PageComponent);\n}\n\n\n"]},"metadata":{},"sourceType":"module"}